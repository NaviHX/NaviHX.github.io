<!doctype html>
<html lang="en">
   <head>
      <meta charset="UTF-8">
      <meta content="IE=edge" http-equiv="X-UA-Compatible"/>
      <meta content="text/html; charset=UTF-8" http-equiv="content-type"/>
      <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
      <meta name="robots" content="index, follow">
      
      
      
      
      
      
      
      
      
      
      
      
      <title>Subseq Sum Permutations</title>
      
      
      
      <meta name="title" content="Subseq Sum Permutations">
      
      
      
      <meta property="og:type" content="website">
      <meta property="og:url" content="https://refrigerator.navihx.top/posts/subseq-sum-perm/">
      
      <meta property="og:site_name" content="">
      
      
      <meta property="og:title" content="Subseq Sum Permutations">
      
      
      
      <meta property="og:image" content="https:&#x2F;&#x2F;refrigerator.navihx.top&#x2F;favicon.ico">
      
      
      
      <meta property="twitter:card" content="summary_large_image">
      <meta property="twitter:url" content="https://refrigerator.navihx.top/posts/subseq-sum-perm/">
      
      <meta property="twitter:title" content="Subseq Sum Permutations">
      
      
      
      <meta property="twitter:image" content="https:&#x2F;&#x2F;refrigerator.navihx.top&#x2F;favicon.ico">
      
      
      <link rel="canonical" href="https://refrigerator.navihx.top/posts/subseq-sum-perm/">
      
      <link rel="shortcut icon" type="image/x-icon" href="https://refrigerator.navihx.top/favicon.ico">
      
      
      
      
      <link rel="alternate" type="application/atom+xml" title="RSS" href="https://refrigerator.navihx.top/atom.xml">
      
      
      
      <link rel="stylesheet" href="https://refrigerator.navihx.top/css/style.css"/>
      
   </head>
   <body>
      <div class="wrapper">
         <header>
            
            <nav class="navBar">
               
               
               
               <a href="/" >&#x2F;home&#x2F;</a>
               
               
               
               
               <a href="/posts" >&#x2F;posts&#x2F;</a>
               
               

               <div class="themeSwitch">
                  <button class="themeButton light" onclick="setTheme('light')" title="Light mode">◐</button>
                  <button class="themeButton dark" onclick="setTheme('dark')" title="Dark mode">◑</button>
               </div>
            </nav>
            

            <script>
               const setTheme = (theme) => {
                   document.documentElement.className = theme;
                   localStorage.setItem('theme', theme);
               }
               const getTheme = () => {
                   const theme = localStorage.getItem('theme');
                   theme && setTheme(theme);
               }
               getTheme()
            </script>
         </header>

         <main>
            




<h1 id="qiu-zi-xu-lie-de-di-k-xiao-he">求子序列的第 k 小和</h1>
<p>给定一个正整数数组 <code>nums</code> 和 一个非负数 <code>k</code> ，求出第 k 小的子序列和。</p>
<p>相同的不同子序列之和视为不同的和。同时空子序列的和记为 0 。例如对于数组 <code>[1, 2, 3]</code> ，它的子序列和的从小到大的排列是</p>
<pre data-lang="text" style="background-color:#2b303b;color:#c0c5ce;" class="language-text "><code class="language-text" data-lang="text"><span>[
</span><span>    0 = [],
</span><span>    1 = [1],
</span><span>    2 = [2],
</span><span>    3 = [3],
</span><span>    3 = [1, 2],
</span><span>    4 = [1, 3],
</span><span>    5 = [2, 3],
</span><span>    6 = [1, 2, 3]
</span><span>]
</span></code></pre>
<h1 id="solution">Solution</h1>
<p>在任意一个子序列中，每一个数组中的元素要么出现在这个子序列中，要么没有出现。一个数组的子序列构成的集合实际上就是它的幂集，假设这个数组有 len 个元素，那么我们可以用长度为 len 位的数唯一地确定这个幂集中的一个子序列：0 表示该位对应的元素没有出现在子序列中，1 则表示出现。所以，上面例子中的所有子序列可以表示为下面的数字：</p>
<pre data-lang="text" style="background-color:#2b303b;color:#c0c5ce;" class="language-text "><code class="language-text" data-lang="text"><span>[
</span><span>    0 = [] = 0,
</span><span>    1 = [1] = 1,
</span><span>    2 = [2] = 2,
</span><span>    3 = [3] = 4,
</span><span>    3 = [1, 2] = 3,
</span><span>    4 = [1, 3] = 5,
</span><span>    5 = [2, 3] = 6,
</span><span>    6 = [1, 2, 3] = 7
</span><span>]
</span></code></pre>
<p>定义 S 为从表示子序列的数到子序列和的映射，问题转换为我们需要找到一个枚举子序列数 p 的方法满足：</p>
<ul>
<li>S(p) 从小到大枚举。</li>
<li>不重复。</li>
</ul>
<p>满足第一个要求很简单：只需要将 S(p) 加入到一个小根堆中，使用堆排序。我们知道最小的子序列和一定是 0 对应的子序列 [] ，所以对于一个元素个数大于 0 的已从小到大排序的数组，除了空序列外，最小的子序列一定是 1 对应的 [n[0]]。所以我们只需要找到一个方法，从 1 出发，不重复地找到所有长度小于等于 len 位的数。</p>
<p>假设我们已经枚举了长度小于等于 l 的所有数，现在需要枚举所有长度等于 l + 1 的数。首先，对于长度为 l + 1 的数，其第 l 位一定是 1 ，第 l - 1 位要么是 0 要么是 1 ，这意味着对于一个长度等于 l + 1 的数 p 来说，总是存在唯一一个长度为 l 或 l - 1 的数 q 将第 l 位置一得到的，S(p) = S(q) + n[l] 。同时，这个长度为 l - 1 的数也可以通过一个长度为 l 的数通过将第 l - 1 位置零得到。所以，假设我们现在有一个长度为 l 的数 p ，我们可以求到两个长度为 l + 1 的数对应的 S :</p>
<pre data-lang="text" style="background-color:#2b303b;color:#c0c5ce;" class="language-text "><code class="language-text" data-lang="text"><span>S(q1) = S(p) + n[l]
</span><span>S(q2) = S(p) + n[l] - n[l - 1]
</span></code></pre>
<p>因为每个数的来源是唯一的，所以通过这种方法枚举的数是不重复的，同时所有数都能枚举到（从个数来看），所以这个枚举方法是满足要求的。</p>
<pre data-lang="rust" style="background-color:#2b303b;color:#c0c5ce;" class="language-rust "><code class="language-rust" data-lang="rust"><span style="color:#b48ead;">fn </span><span style="color:#8fa1b3;">perm_sub_sum</span><span>(</span><span style="color:#bf616a;">nums</span><span>: &amp;</span><span style="color:#b48ead;">mut</span><span> [</span><span style="color:#b48ead;">i32</span><span>]) -&gt; Vec&lt;</span><span style="color:#b48ead;">i32</span><span>&gt; {
</span><span>    </span><span style="color:#b48ead;">use </span><span>std::cmp::Reverse;
</span><span>    </span><span style="color:#b48ead;">use </span><span>std::collections::BinaryHeap;
</span><span>
</span><span>    </span><span style="color:#b48ead;">let</span><span> len = nums.</span><span style="color:#96b5b4;">len</span><span>();
</span><span>    </span><span style="color:#b48ead;">let mut</span><span> heap = BinaryHeap::new();
</span><span>    </span><span style="color:#b48ead;">let mut</span><span> sums = vec![</span><span style="color:#d08770;">0</span><span>];
</span><span>    nums.</span><span style="color:#96b5b4;">sort_unstable</span><span>();
</span><span>    heap.</span><span style="color:#96b5b4;">push</span><span>((Reverse(nums[</span><span style="color:#d08770;">0</span><span>]), </span><span style="color:#d08770;">0</span><span>));
</span><span>
</span><span>    </span><span style="color:#b48ead;">while let </span><span>Some((Reverse(sum), i)) = heap.</span><span style="color:#96b5b4;">pop</span><span>() {
</span><span>        sums.</span><span style="color:#96b5b4;">push</span><span>(sum);
</span><span>        </span><span style="color:#b48ead;">if</span><span> i &lt; len - </span><span style="color:#d08770;">1 </span><span>{
</span><span>            heap.</span><span style="color:#96b5b4;">push</span><span>((Reverse(sum + nums[i + </span><span style="color:#d08770;">1</span><span>]), i + </span><span style="color:#d08770;">1</span><span>));
</span><span>            heap.</span><span style="color:#96b5b4;">push</span><span>((Reverse(sum + nums[i + </span><span style="color:#d08770;">1</span><span>] - nums[i]), i + </span><span style="color:#d08770;">1</span><span>));
</span><span>        }
</span><span>    }
</span><span>
</span><span>    sums
</span><span>}
</span></code></pre>


         </main>

         <footer>
            
<p class="tagsData">

</p>

            <hr>
            <div class=footContainer>
               <div class="footLeft">
                  <p>Licensed under <a target="_blank" rel="noopener noreferrer" href="https://fr.wikipedia.org/wiki/Licence_MIT">MIT</a><br>
                     Built with <a target="_blank" rel="noopener noreferrer" href="https://www.getzola.org">Zola</a> using <a target="_blank" rel="noopener noreferrer" href="https://github.com/Speyll/anemone">anemone</a> theme &amp; <a target="_blank" rel="noopener noreferrer" href="https://github.com/Speyll/veqev">veqev</a> colors.<br>
                  </p>
               </div>
               <div class="footRight">
                  <!-- Size 46x46 -->
                  <img class="footGif noStyle" loading="lazy" src="https://i.ibb.co/XYDpfcs/foot.gif" alt="footGif">
                  <a class="metaData" target="_blank" rel="noopener noreferrer" href="https://refrigerator.navihx.top/atom.xml" title="Subscribe via RSS for updates.">RSS</a>
               </div>
            </div>
         </footer>
      </div>
   </body>
</html>
